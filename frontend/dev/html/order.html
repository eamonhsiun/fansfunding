@@include('include/head.html',{"title": "支付订单 | FAN$","csstype": "order"})
@@include('include/header.html',{"page": "order"})
  <div class="container" id="order">
    <div class="kit-progress-tab">
      <ul>
        <li class="kit-tab FFtab">确认订单</li>
        <li class="kit-tab FFtab">确认支付</li>
        <li class="kit-tab FFtab">支付结果</li>
      </ul>
    </div>
    <div class="order-progress">
      <div class="FFtab-content"id="order-info">
        <div class="block-title">订单信息</div>
        <div class="kit-wrap">
          <div class="kit-group" id="order-project">
            <a href="project-vue.html?categoryId={{categoryId}}&id={{projectId}}" target="_blank">
              <div class="kit-block kit-content">
                <div id="order-project-info">
                  <div class="project-cover">
                    <img :src="project.data.cover | resource" alt="">
                  </div>
                  <div class="project-content">
                    <div class="project-title">{{project.data.name}}</div>
                    <div class="project-description">{{project.data.description}}</div>
                  </div>
                </div>
              </div>
            </a>
          </div>
          <div class="kit-group" id="order-feedback">
            <div class="kit-block kit-content">
              <div class="feedback-money">支持<span>{{feedback.target.limitation}}</span>元</div>
              <div class="feedback-num">已支持<span>{{feedback.target.supportTimes}}</span>人</div>
              <div class="feedback-detail">
                <div class="feedback-detail-content">{{feedback.target.description}}</div>
                <div class="feedback-detail-pics">
                  <div class="feedback-detail-pic" v-for="image in feedback.target.images">
                    <img v-bind:src="image | resource" alt="">
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="kit-group" id="order-money">
            <div class="kit-block kit-content">
              实际支付金额：<span>{{order.money}}</span>元
            </div>
          </div>
        </div>
        <div class="block-title">地址选择</div>
        <div class="kit-wrap" id="order-address">
          <div class="address-list" :class="{'selected': index == address.selected}" v-for="(index, addr) in address.list" @click.prevent="selectUserAddress(index)">
            <div class="kit-block kit-content address-block">
              <div>
                <div class="address-content">
                  <span class="address-hint">姓名：</span>
                  <span class="address-inner">{{addr.name}}</span>
                </div>
                <div class="address-content">
                  <span class="address-hint">省市区：</span>
                  <span class="address-inner">{{addr.province}} {{addr.city}} {{addr.district}}</span>
                </div>
                <div class="address-content">
                  <span class="address-hint">详细地址：</span>
                  <span class="address-inner">{{addr.address}}</span>
                </div>
                <div class="address-content">
                  <span class="address-hint">邮编：</span>
                  <span class="address-inner">{{addr.postCode}}</span>
                </div>
                <div class="address-content">
                  <span class="address-hint">电话：</span>
                  <span class="address-inner">{{addr.phone}}</span>
                </div>
              </div>
              <div class="address-default" :class="{'default': index == address.default}" @click.prevent="setDefaultUserAddress(index)">{{ index == address.default ? "默认地址" : "设为默认地址" }}</div>
            </div>
          </div>
          <div class="address-list" id="address-add">
            <div class="kit-block kit-content address-block">
              <div class="address-add-mask" :class="{'active': address.maskHide}" @click.stop="removeAddressMask">
                <span>添加收货地址</span>
              </div>
              <div class="address-add-content">
                <div class="address-content">
                  <span class="address-hint">姓名：</span>
                  <span class="address-inner"><input type="text" v-model="address.newAddress.name"></span>
                </div>
                <div class="address-content">
                  <span class="address-hint">省市区：</span>
                  <span class="address-inner">
                    <input type="text" v-model="address.newAddress.province">
                    <input type="text" v-model="address.newAddress.city">
                    <input type="text" v-model="address.newAddress.district">
                  </span>
                </div>
                <div class="address-content">
                  <span class="address-hint">详细地址：</span>
                  <span class="address-inner"><input type="text" v-model="address.newAddress.address"></span>
                </div>
                <div class="address-content">
                  <span class="address-hint">邮编：</span>
                  <span class="address-inner"><input type="text" v-model="address.newAddress.postCode"></span>
                </div>
                <div class="address-content">
                  <span class="address-hint">电话：</span>
                  <span class="address-inner"><input type="text" v-model="address.newAddress.phone"></span>
                </div>
                <div class="address-add-btn FFbtn" @click.prevent="addUserAddress">添加</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="FFtab-content">
        <div class="block-title">支付信息</div>
        <div class="kit-block kit-content" id="pay-confirm">
          <div class="pay-info">在新窗口完成支付</div></div>
      </div>
      <div class="FFtab-content">
        <div class="block-title">支付结果</div>
        <div class="kit-block kit-content">
          <div class="pay-result">
            <div class="pay-icon" :class="{'failure': !orderStatus}"></div>
            <div class="pay-content">
              <div class="pay-msg">支付{{ orderStatus ? "成功" : "失败" }}</div>
              <div>
                <div class="FFbtn pay-btn" @click.prevent="redirect('project')">返回项目</div>
                <div class="FFbtn pay-btn" v-if="orderStatus" @click.prevent="redirect('order')">查看订单</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="order-step">
      <div class="order-submit FFbtn" @click.prevent="submitOrder" v-if="step == 1">确认订单</div>
      <div class="order-success order-step-two FFbtn" v-if="step == 2" @click.prevent="redirect('project')">支付成功</div>
      <div class="order-failure order-step-two FFbtn" v-if="step == 2" @click.prevent="cancelOrder()">支付失败</div>
    </div>
  </div>


@@include('include/footer.html')
@@include('include/script.html',{"jstype": "order"})
