@@include('include/head.html',{"title": "个人空间 | FAN$","csstype": "space"})
@@include('include/header.html',{"page": "space"})
  <div class="container">
    <div class="content-wrap" id="space">
      <div class="block-title">用户空间</div>
      <div class="space-wrap">
        <div class="group-wrap" id="user-group">
          <div class="kit-block" id="user-info">
            <div class="user-header">
              <div class="user-avatar"><img v-bind:src="spaceUserInfo.head | resource"  alt=""></div>
              <div class="user-info">
                <div class="user-name"><span v-text="spaceUserInfo.nickname"></span></div>
                <div class="user-intro">{{ spaceUserInfo.intro }}</div>
              </div>
            </div>
            <div class="kit-bottombar" v-if="!isSelf">
              <div class="kit-bottombar-btn" :class="{'active': isFollowed}" @click.prevent="followUser" v-text='isFollowed ? "已关注" : "关注"'></div>
            </div>
          </div>
          <div class="kit-block" id="user-data">
            <div class="">
               <ul>
                 <li class="user-data-list">
                   <div class="user-data-follow">关注<span></span></div>
                   <div class="user-data-fans">粉丝<span></span></div>
                 </li>
                 <li class="user-data-list">
                   支持的项目<span v-text="projects.support.pagination.total"></span>
                 </li>
                 <li class="user-data-list">
                   发布的动态<span v-text="moments.pagination.total"></span>
                 </li>
                 <li class="user-data-list">
                   发起的项目<span v-text="projects.sponsor.pagination.total"></span>
                 </li>
               </ul>
            </div>
          </div>
        </div>
        <div class="group-wrap" id="content-group">
          <div class="kit-block">
            <div class="kit-tabs FFtabs">
              <ul>
                <li class="kit-tab FFtab">最近项目</li>
                <li class="kit-tab FFtab" @click.prevent="getRecentMoment(0)">最近动态</li>
                <li class="kit-tab FFtab" v-show="isSelf" @click.prevent="getRecentOrder(0)">我的订单</li>
              </ul>
            </div>
          </div>
          <div class="FFtab-contents">
            <div class="kit-wrap FFtab-content">
              <div class="kit-block">
                <div class="kit-title">
                  <span class="kit-title-left">发起</span>
                  <span class="kit-title-right"><a href="">更多</a></span>
                </div>
                <div class="kit-content">
                  <template id="space-project-list-template">
                    <div class="space-kit-hint" v-if="projects.length == 0">没有相关项目</div>
                    <ul>
                      <li class="space-project-list" v-for="project in projects">
                        <a href="project-vue.html?categoryId={{project.categoryId}}&projectId={{project.id}}">
                          <div class="project-cover">
                            <img :src="project.cover | resource" alt="">
                          </div>
                          <div class="project-content">
                            <div class="project-title">{{project.name}}</div>
                            <div class="project-description">{{project.description}}</div>
                            <div class="project-detail">
                              <div class="project-detail-info project-lefttime">
                                剩余时间：<span>{{ getLeftTime(new Date(), project.targetDeadline) }}</span>
                              </div>
                              <div class="project-detail-info project-target">
                                目标金额：<span>{{project.targetMoney | currency '￥' 0}}</span>
                              </div>
                              <div class="project-detail-info project-progress">
                                已达成：<span>{{project.sum/project.targetMoney*100 | currency '' 2}}</span>%
                              </div>
                            </div>
                          </div>
                        </a>
                      </li>
                    </ul>
                  </template>
                  <space-project-list :projects="projects.sponsor.list.slice(0,3)">
                  </space-project-list>
                </div>
              </div>
              <div class="kit-block">
                <div class="kit-title">
                  <span class="kit-title-left">关注</span>
                  <span class="kit-title-right"><a href="">更多</a></span>
                </div>
                <div class="kit-content">
                  <space-project-list :projects="projects.follow.list.slice(0,3)">
                  </space-project-list>
                </div>
              </div>
              <div class="kit-block">
                <div class="kit-title">
                  <span class="kit-title-left">支持</span>
                  <span class="kit-title-right"><a href="">更多</a></span>
                </div>
                <div class="kit-content">
                  <space-project-list :projects="projects.support.list.slice(0,3)">
                  </space-project-list>
                </div>
              </div>
            </div>
            <div class="kit-wrap FFtab-content">
              <div class="kit-block">
                <div class="kit-title">
                  <span class="kit-title-left">动态</span>
                  <span class="kit-title-right"><a href="">更多</a></span>
                </div>
                <div class="kit-content" id="moment">
                  <div class="comment-text comment-wrap" v-if="isSelf" v-bind:class="{ 'show' : isSelf }">
                    <div class="comment-userinfo">
                      <div class="comment-avatar">
                        <img v-bind:src="userInfo.head | resource" alt="">
                      </div>
                      <div class="comment-userinfo-name">{{ userInfo.nickname }}</div>
                      <!-- <div class="comment-unerinfo-intro">口发起头衔是什么好口怕发怕么好口怕</div> -->
                    </div>
                    <div class="comment-input">
                      <textarea name="" id="moment-textarea" cols="30" rows="10" v-model="moments.content"></textarea >
                      <div class="comment-input-more">
                        <div class="comment-hint" id="moment-hint" v-text="moments.hint" v-bind:class="{'overflow':moments.overflow}"></div>
                        <div class="comment-submit" id="comment-submit" v-on:click="sendMoment">发表动态</div>
                      </div>
                    </div>
                  </div>
                  <div class="kit-loader FFloader" id="moment-loader">
                    <div class="loader-inner triangle-skew-spin">
                      <div></div>
                    </div>
                  </div>
                  <div id="moment-errormsg" class="kit-errormsg FFerrormsg">发起人还没有发布动态</div>
                  <ul>
                    <li class="moment-wrap comment-wrap" v-for="moment in moments.list" track-by="$index">
                      <div class="moment-userinfo comment-userinfo">
                        <div class="moment-avatar comment-avatar">
                          <img v-bind:src="moment.sponsorHead | resource" alt="">
                        </div>
                        <a href="space.html?userid={{moment.userId}}"><div class="moment-userinfo-name comment-userinfo-name">{{ moment.nickname }}</div></a>
                        <!-- <div class="moment-userinfo-intro comment-userinfo-intro">口发起头衔是什么好口怕发怕么好口怕</div> -->
                      </div>
                      <div class="moment-content comment-content">
                        <div class="moment-inner comment-inner">{{ moment.content }}</div>
                        <div class="moment-images comment-images">
                          <div class="comment-image" v-for="image in moment.images" track-by="$index">
                            <img class="zoom" v-bind:src="image | resource" @click.prevent="viewPic" alt="">
                          </div>
                        </div>
                        <div class="moment-more comment-more">
                          <div class="moment-time comment-time">{{ moment.postTime | commentTime }}</div>
                          <div class="moment-btns comment-btns">
                            <div class="moment-btn moment-like comment-btn comment-like" v-text="moment.likeNum"></div>
                            <div class="comment-btn comment-reply" v-on:click.prevent="replyComment(comment.commenterId, comment.commenterNickname)">评论</div>
                            <div class="comment-btn comment-reply" v-on:click.prevent="replyComment(comment.commenterId, comment.commenterNickname)">转发</div>
                          </div>
                        </div>
                      </div>
                    </li>
                  </ul>
                  <pagination :pagination="moments.pagination" :callback="getRecentMoment" :offset="3"></pagination>
                </div>
              </div>
            </div>
            <div class="kit-wrap FFtab-content">
              <div class="kit-block">
                <div class="kit-title">
                  <span class="kit-title-left">订单</span>
                  <span class="kit-title-right"><a href="">更多</a></span>
                </div>
                <div class="kit-content">
                  <template id="space-order-list-template">
                    <div class="space-kit-hint" v-if="orders.length == 0">没有订单</div>
                    <ul>
                      <li class="space-order-list" v-for="order in orders">
                        <a href="order-detail.html?orderNo={{order.orderNo}}">
                          <div class="order-cover">
                            <img :src="order.feedbackImages[0] | resource" alt="">
                          </div>
                          <div class="order-content">
                            <div class="order-title">{{order.projectName}}</div>
                            <div class="order-feedback-title">{{order.feedbackTitle}}</div>
                            <div class="order-detail">
                              <div class="order-detail-money">{{order.totalFee}}</div>
                              <div class="order-detail-no">{{order.tradeNo}}</div>
                              <div class="order-detail-time">{{order.paidTime | time}}</div>
                            </div>
                          </div>
                        </a>
                      </li>
                    </ul>
                    <pagination :pagination="pagination" :callback="callback" :offset="3"></pagination>
                  </template>
                  <space-order-list :orders="orders.list" :pagination="orders.pagination" :callback="getRecentOrder"></space-order-list>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <ffviewer :status.sync="picViewer.status" :imgsrc="picViewer.src"></ffviewer>
    </div>
  </div>
@@include('include/footer.html')
@@include('include/script.html',{"jstype": "space"})
